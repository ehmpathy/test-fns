# execution log: vitest + jest isomorphism

## phase 1: infrastructure layer

### 1.1 getRequire

- [x] create `src/infra/isomorph.node/getRequire.ts`
- [x] create `src/infra/isomorph.node/getRequire.jest.test.ts`

### 1.2 detectTestRunner

- [x] create `src/infra/isomorph.test/detectTestRunner.ts`
- [x] create `src/infra/isomorph.test/detectTestRunner.jest.test.ts`

### 1.3 getTestGlobals

- [x] create `src/infra/isomorph.test/getTestGlobals.ts`
- [x] create `src/infra/isomorph.test/getTestGlobals.jest.test.ts`

### 1.4 runTest

- [x] create `src/infra/isomorph.test/runTest.ts`
- [x] create `src/infra/isomorph.test/runTest.jest.test.ts`

---

## phase 2: domain operations + contract

### 2.1 restructure files

- [x] move source files to `src/domain.operations/`
- [x] rename `*.test.ts` to `*.jest.test.ts`
- [x] update imports in test files and src/index.ts

### 2.2 modify givenWhenThen

- [x] modify to use infra adapters (globals(), getTestRunner())

### 2.3 modify usePrep

- [x] modify to use infra adapters (globals())

### 2.4 contract layer

- [x] create `src/contract/index.ts`
- [x] update `src/index.ts` to re-export from contract

---

## phase 3: vitest infrastructure

### 3.1 dependencies

- [x] add `vitest` to devDependencies
- [x] add `@jest/globals` to devDependencies
- [ ] add peer dependencies

### 3.2 vitest config

- [x] create `vitest.config.ts`

### 3.3 jest config update

- [x] update jest configs to match `.jest.test.ts` files only

### 3.4 npm scripts

- [x] add `test:vitest`, `test:vitest:watch` scripts
- [x] update `test` script to run both jest and vitest

---

## phase 4: vitest tests

### 4.1 infra vitest tests

- [ ] create getRequire.vitest.test.ts
- [ ] create detectTestRunner.vitest.test.ts
- [ ] create getTestGlobals.vitest.test.ts
- [ ] create runTest.vitest.test.ts

### 4.2 domain operations vitest tests

- [ ] create givenWhenThen.vitest.test.ts
- [ ] create usePrep.vitest.test.ts

---

## phase 5: acceptance tests

- [ ] create jest acceptance test
- [ ] create vitest acceptance test

---

## phase 6: documentation

- [ ] update README.md

---

## final verification

- [ ] all tests pass
- [ ] build succeeds
